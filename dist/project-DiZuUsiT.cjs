"use strict";const h=require("node:util"),e=require("sequelize"),d=require("dotenv");d.config();const m={host:process.env.HOST||"0.0.0.0",port:process.env.PORT||3e3,secure:process.env.SECURE||!1},v={dialect:process.env.DATABASE_DIALECT||"postgres",database:process.env.DATABASE_DBNAME,user:process.env.DATABASE_USER,password:process.env.DATABASE_PASSWORD,host:process.env.DATABASE_HOST,port:process.env.DATABASE_PORT,ssl:process.env.DATABASE_SSL||!1},C={accessToken:{type:process.env.ACCESS_TOKEN_TYPE||"Bearer",algorithm:process.env.ACCESS_TOKEN_ALGORITHM||"HS256",secret:process.env.ACCESS_TOKEN_SECRET||"Acc3ssTok3nS3c3t!",expiresIn:process.env.ACCESS_TOKEN_EXPIRES_IN_MS||60*60*1e3,audience:process.env.ACCESS_TOKEN_AUDIENCE||"my_backend_api",issuer:process.env.ACCESS_TOKEN_ISSUER||"my_authentication_server"},crypto:{scrypt:{saltLength:process.env.SCRYPT_SALT_LENGTH||16,hashLength:process.env.SCRYPT_HASH_LENGTH||64,cost:process.env.SCRYPT_COST||Math.pow(2,17),blockSize:process.env.SCRYPT_BLOCK_SIZE||8,parallelization:process.env.SCRYPT_PARALLELIZATION||1,maxmem:process.env.SCRYPT_MAXMEM|134220800},unsaltedHashAlgorithm:process.env.FAST_HASH_ALGORITHM||"sha256"}},o={auth:C,database:v,server:m},a={};async function R(s){const r=h.promisify(a.scrypt),{saltLength:c,hashLength:n,cost:p,blockSize:i,parallelization:S,maxmem:T}=o.auth.crypto.scrypt,t=a.randomBytes(c).toString("hex");return`${(await r(s,t,n,{cost:p,blockSize:i,parallelization:S,maxmem:T})).toString("hex")}.${t}`}async function f(s,r){const[c,n]=r.split("."),p=Buffer.from(c,"hex"),i=h.promisify(a.scrypt),{hashLength:S,cost:T,blockSize:t,parallelization:l,maxmem:u}=o.auth.crypto.scrypt,y=await i(s,n,S,{cost:T,blockSize:t,parallelization:l,maxmem:u});return a.timingSafeEqual(p,y)}const{dialect:N,database:D,user:I,password:g,host:B,port:L}=o.database,A=new e.Sequelize({dialect:N,database:D,username:I,password:g,host:B,port:L,ssl:!1,clientMinMessages:"notice"});class E extends e.Model{}E.init({username:{type:e.DataTypes.STRING},email:{type:e.DataTypes.STRING,unique:!0},password:{type:e.DataTypes.STRING}},{sequelize:A,timestamps:!0});class _ extends e.Model{}_.init({name:{type:e.DataTypes.STRING},description:{type:e.DataTypes.STRING},image:{type:e.DataTypes.STRING}},{sequelize:A});exports.Project=_;exports.User=E;exports.compare=f;exports.config=o;exports.hash=R;exports.sequelize=A;
