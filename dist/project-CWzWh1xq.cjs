"use strict";const a=require("node:crypto"),u=require("node:util"),e=require("sequelize"),m=require("dotenv");m.config();const f={host:process.env.HOST||"0.0.0.0",port:process.env.PORT||3e3,secure:process.env.SECURE||!1},C={dialect:"postgres",database:"bapo4388_portfolio",user:"bapo4388_backend_portfolio",password:"Portfolio2025!",host:"localhost",port:"5432",ssl:"1"},R={accessToken:{type:process.env.ACCESS_TOKEN_TYPE||"Bearer",algorithm:process.env.ACCESS_TOKEN_ALGORITHM||"HS256",secret:process.env.ACCESS_TOKEN_SECRET||"Acc3ssTok3nS3c3t!",expiresIn:process.env.ACCESS_TOKEN_EXPIRES_IN_MS||60*60*1e3,audience:process.env.ACCESS_TOKEN_AUDIENCE||"my_backend_api",issuer:process.env.ACCESS_TOKEN_ISSUER||"my_authentication_server"},crypto:{scrypt:{saltLength:process.env.SCRYPT_SALT_LENGTH||16,hashLength:process.env.SCRYPT_HASH_LENGTH||64,cost:process.env.SCRYPT_COST||Math.pow(2,17),blockSize:process.env.SCRYPT_BLOCK_SIZE||8,parallelization:process.env.SCRYPT_PARALLELIZATION||1,maxmem:process.env.SCRYPT_MAXMEM|134220800},unsaltedHashAlgorithm:process.env.FAST_HASH_ALGORITHM||"sha256"}},o={auth:R,database:C,server:f};async function v(s){const r=u.promisify(a.scrypt),{saltLength:c,hashLength:n,cost:p,blockSize:i,parallelization:S,maxmem:l}=o.auth.crypto.scrypt,t=a.randomBytes(c).toString("hex");return`${(await r(s,t,n,{cost:p,blockSize:i,parallelization:S,maxmem:l})).toString("hex")}.${t}`}async function A(s,r){const[c,n]=r.split("."),p=Buffer.from(c,"hex"),i=u.promisify(a.scrypt),{hashLength:S,cost:l,blockSize:t,parallelization:T,maxmem:d}=o.auth.crypto.scrypt,E=await i(s,n,S,{cost:l,blockSize:t,parallelization:T,maxmem:d});return a.timingSafeEqual(p,E)}const{dialect:N,database:g,user:I,password:P,host:L,port:b}=o.database,h=new e.Sequelize({dialect:N,database:g,username:I,password:P,host:L,port:b,ssl:!1,clientMinMessages:"notice"});class _ extends e.Model{}_.init({username:{type:e.DataTypes.STRING},email:{type:e.DataTypes.STRING,unique:!0},password:{type:e.DataTypes.STRING}},{sequelize:h,timestamps:!0});class y extends e.Model{}y.init({name:{type:e.DataTypes.STRING},description:{type:e.DataTypes.STRING},image:{type:e.DataTypes.STRING}},{sequelize:h});exports.Project=y;exports.User=_;exports.compare=A;exports.config=o;exports.hash=v;exports.sequelize=h;
